extensions:  ["semantiva-imaging"]

pipeline:
  nodes:
    - processor: TwoDGaussianSingleChannelImageGenerator
      derive:
        parameter_sweep:
          parameters:
            x_0: "50 + 5 * t"
            y_0: "50 + 5 * t + 5 * t ** 2"
            std_dev: "(50 + 20 * t, 20)"
            angle: "60 + 5 * t"
          variables:
            t: {lo: -1, hi: 2, steps: 3}
          collection: SingleChannelImageStack
      parameters:
        image_size: [128, 128]
        amplitude: 100

    - processor: "slice:TwoDTiltedGaussianFitterProbe:SingleChannelImageStack"
      context_key: "gaussian_fit_parameters"

    - processor: ModelFittingContextProcessor
      parameters:
        fitting_model: "model:PolynomialFittingModel:degree=1"
        independent_var_key: "t_values"
        dependent_var_key: "gaussian_fit_parameters.std_dev_x"
        context_key: "std_dev_coefficients"

    - processor: ModelFittingContextProcessor
      parameters:
        fitting_model: "model:PolynomialFittingModel:degree=1"
        independent_var_key: "t_values"
        dependent_var_key: "gaussian_fit_parameters.angle"
        context_key: "orientation_coefficients"
